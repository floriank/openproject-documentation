                            <h1>Packaged Installation Community</h1>
<h2>OpenProject installation via package manager</h2>
<p>The installation of the OpenProject software can be done manually or via official software-packages build by the packager.io service. Using these software packages is highly recommended to reduce the pain of installation and configuration errors. Besides the installation via package manager is done via configuration wizard which is very helpful to get everything up and running right from the beginning.</p>
<h3>Stack used by packager.io packages</h3>
<ul>
<li>Unicorn (application server) &#8211; this component hosts the actual application. Depending on the settings chosen, there are at least two unicorn processes running in parallel on the app server machine.</li>
<li>Apache 2 (web server) &#8211; this component provides the external interface, handles SSL termination (if SSL is used) and distributes/forwards web requests to the unicorn processes.</li>
<li>MySQL (database management system) &#8211; this component is used to store and retrieve data.</li>
<li>Ruby 2.1.3 (MRI) and necessary libraries to run the OpenProject source code.</li>
</ul>
<h2>Run Installation</h2>
<p>The installation procedure assumes the following prerequisites to be met:</p>
<ul>
<li>A server running one of the following Linux distributions to perform the installation on:
<ul>
<li><strong>Debian 7.6 Wheezy 64 bits server</strong></li>
<li><strong>Ubuntu 14.04 Trusty 64bits server</strong></li>
<li><strong>Fedora 20 64bits server</strong></li>
<li><strong>CentOS 6 / RHEL 6 64 bits server </strong></li>
</ul>
</li>
<li>A mail server that is accessible via SMTP that can be used for sending notification emails. OpenProject supports authentication, yet does not provide support for SMTP via SSL/TLS.</li>
</ul>
<p>If you intend to use SSL for OpenProject:</p>
<ul>
<li>A valid SSL certifificate along with the private key file. The files must not be protected by a pass phrase.</li>
<li>Note that as the installation procedure will automatically create a separate user to run OpenProject as, it is not necessary to create such a user beforehand.</li>
</ul>
<p>The following steps have to be performed to initiate the actual installation of OpenProject via package manager. Note that all commands should either be run as root or should be prepended by sudo otherwise (typically depending what linux distribution is used).</p>
<h3>Debian 7 Wheezy 64bits server</h3>
<pre class="lang:default decode:true"># install https support
apt-get install apt-transport-https</pre>
<pre><code>wget <span class="hljs-attribute">-qO</span> <span class="hljs-subst">-</span> https:<span class="hljs-comment">//deb.packager.io/key | sudo apt-key add -</span>
echo <span class="hljs-string">"deb https://deb.packager.io/gh/finnlabs/pkgr-openproject-community wheezy stable"</span> <span class="hljs-subst">|</span> sudo tee /etc/apt/sources<span class="hljs-built_in">.</span><span class="hljs-built_in">list</span><span class="hljs-built_in">.</span>d/pkgr<span class="hljs-attribute">-openproject</span><span class="hljs-attribute">-community</span><span class="hljs-built_in">.</span><span class="hljs-built_in">list</span>
sudo apt<span class="hljs-attribute">-get</span> update
sudo apt<span class="hljs-attribute">-get</span> install openproject<span class="hljs-attribute">-ce</span></code></pre>
<h3> Ubuntu 14.04 Trusty 64bits server</h3>
<pre><code>wget <span class="hljs-attribute">-qO</span> <span class="hljs-subst">-</span> https:<span class="hljs-comment">//deb.packager.io/key | sudo apt-key add -</span>
echo <span class="hljs-string">"deb https://deb.packager.io/gh/finnlabs/pkgr-openproject-community trusty stable"</span> <span class="hljs-subst">|</span> sudo tee /etc/apt/sources<span class="hljs-built_in">.</span><span class="hljs-built_in">list</span><span class="hljs-built_in">.</span>d/pkgr<span class="hljs-attribute">-openproject</span><span class="hljs-attribute">-community</span><span class="hljs-built_in">.</span><span class="hljs-built_in">list</span>
sudo apt<span class="hljs-attribute">-get</span> update
sudo apt<span class="hljs-attribute">-get</span> install openproject<span class="hljs-attribute">-ce</span></code></pre>
<h3> Fedora 20 64bits server</h3>
<pre><code>sudo rpm <span class="hljs-subst">--</span><span class="hljs-keyword">import</span> https:<span class="hljs-comment">//rpm.packager.io/key</span>
echo <span class="hljs-string">"[pkgr-openproject-community]
name=Repository for finnlabs/pkgr-openproject-community application.
baseurl=https://rpm.packager.io/gh/finnlabs/pkgr-openproject-community/fedora20/stable
enabled=1"</span> <span class="hljs-subst">|</span> sudo tee /etc/yum<span class="hljs-built_in">.</span>repos<span class="hljs-built_in">.</span>d/pkgr<span class="hljs-attribute">-openproject</span><span class="hljs-attribute">-community</span><span class="hljs-built_in">.</span>repo
sudo yum install openproject<span class="hljs-attribute">-ce</span></code></pre>
<h3>CentOS / RHEL 64bits server</h3>
<pre><code>sudo rpm <span class="hljs-subst">--</span><span class="hljs-keyword">import</span> https:<span class="hljs-comment">//rpm.packager.io/key</span>
echo <span class="hljs-string">"[pkgr-openproject-community]
name=Repository for finnlabs/pkgr-openproject-community application.
baseurl=https://rpm.packager.io/gh/finnlabs/pkgr-openproject-community/centos6/stable
enabled=1"</span> <span class="hljs-subst">|</span> sudo tee /etc/yum<span class="hljs-built_in">.</span>repos<span class="hljs-built_in">.</span>d/pkgr<span class="hljs-attribute">-openproject</span><span class="hljs-attribute">-community</span><span class="hljs-built_in">.</span>repo
sudo yum install openproject<span class="hljs-attribute">-ce</span></code></pre>
<h2>Post-Install Configuration</h2>
<p>After the installation of the OpenProject package the system has to be configured to use this package and operate the OpenProject application. Therefore the package includes aconfiguration wizard which can be started using the following command.</p>
<pre><code>sudo openproject-ce configure</code></pre>
<p><strong>Side note:</strong> The installer supports the configuration of necessary SSL connections too. If required the corresponding SSL certificates (incl. keys) have to be placed on the machine.</p>
<h2>OpenProject command line tool</h2>
<p>The `openproject` package comes with a command line tool to help manage important configuration settings. To see all possible command options of this tool type `sudo openproject`.</p>
<pre><code>admin@openproject-demo:~# sudo openproject-ce
    Usage:
      openproject run COMMAND [options]
      openproject scale TYPE=NUM
      openproject logs [--tail|-n NUMBER]
      openproject config:get VAR
      openproject config:set VAR=VALUE
      openproject reconfigure</code></pre>
<h3>Set configuration options</h3>
<p>During the installation process a lot of settings were set to get the application runnings. But if you need to set some advanced options or you want to change some settings which were set during the installation via the installation wizard you can use `config:set` option. Please be aware that you have to stop and restart the application server so that the new configuration is loaded. This can be done using the `service openproject [start|stop]` command. See which settings can be set and an example for setting the session store below.</p>
<pre><code>DATABASE_URL=mysql2://openproject:<a class="email" href="mailto:9ScapYA1MN7JQrPR7Wkmp7y99K6mRHGU@127.0.0.1">9ScapYA1MN7JQrPR7Wkmp7y99K6mRHGU@127.0.0.1</a>:3306/openproject
    SECRET_TOKEN=c5aa99a90f9650404a885cf5ec7c28f7fe1379550bb811cb0b39058f9407eaa216b9b2b22d27f58fb15ac21adb3bd16494ebe89e39ec225ef4627db048a12530</code></pre>
<pre><code>ADMIN_EMAIL=<a class="email" href="mailto:mail@example.com">mail@example.com</a>
    EMAIL_DELIVERY_METHOD=smtp
    SMTP_DOMAIN=10.10.3.6
    SMTP_HOST=127.0.0.1
    SMTP_PASSWORD=mail
    SMTP_PORT=25
    SMTP_URL=smtp://mail:<a class="email" href="mailto:mail@127.0.0.1">mail@127.0.0.1</a>:25/10.10.3.6
    SMTP_USERNAME=mail</code></pre>
<pre><code>WEB_CONCURRENCY=2
WEB_TIMEOUT=15</code></pre>
<pre><code>RAILS_CACHE_STORE=memcache
SESSION_STORE=cach_store</code></pre>
<h3>Example change session store</h3>
<pre><code>sudo service openproject stop
sudo openproject config:set SESSION_STORE="active_record_store"
sudo service openproject start</code></pre>
<p><b>Attention</b>: Be aware that you should only set or change settings which are directly related to the openproject application/instance itself (see the list above). For example settings related to the apache web server can also be set via the `config:set` option but this can end up in an undesired state of the openproject application. If you want to change these settings use the `reconfigure` option. This will bring up the installation wizard again. See the &#8220;Reconfigure via wizard&#8221; section for more details on that.</p>
<h2>Run commands like rake tasks or rails console</h2>
<p>The openproject command line tool supports running rake tasks and known scripts like the rails console. See example below how to do that.</p>
<pre class="lang:default decode:true ">sudo openproject-ce run rails console</pre>
<p>or rake task</p>
<pre class="lang:default decode:true">sudo openproject-ce run rake db:migrate</pre>
<h2>Show logs</h2>
<p>The command line tool can also be used to see the log information. The most typically use case is to show/follow all current log entries. This can be accomplished using the the &#8211;tail flag. See example below.</p>
<pre><code>sudo openproject-ce logs --tail</code></pre>
<h2>Reconfigure via wizard</h2>
<p>As already mentioned in section &#8220;Set configuration options&#8221; if it is necessary to reset all settings defined during the installation process the reconfigure option can be used.</p>
<pre><code>sudo openproject-ce reconfigure</code></pre>
<p>The command above will bring up the installation wizard again. Please be aware that it will start the configuration/installation process from scratch. That is why it won&#8217;t show entries you already made. So you have to fill out every form again.</p>
<h2>Upgrade to a newer version</h2>
<p>Upgrading the OpenProject is as easy as installing a newer OpenProject package and running the <code>openproject configure</code> command.</p>
<h3>Debian / Ubuntu</h3>
<pre><code>sudo apt-get update
sudo apt-get install --only-upgrade openproject-ce
sudo openproject-ce configure</code></pre>
<h3>Fedora / CentOS / RHEL</h3>
<pre><code>sudo yum update
sudo yum install openproject-ce
sudo openproject-ce configure</code></pre>
